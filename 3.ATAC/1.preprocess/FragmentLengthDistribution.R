###################################################################################################
################################     PARAMETER/FUNCTION DEFINE     ################################
###################################################################################################
sys_argv <- commandArgs(T)
cccol <- c("#CE0013","#16557A","#C7A609","#87C232","#008792","#A14C94","#15A08C","#8B7E75","#1E7CAF","#EA425F","#46489A","#E50033","#0F231F","#1187CD")
cccol50 <- c("#CE001350","#16557A50","#C7A60950","#87C23250","#00879250","#A14C9450","#15A08C50","#8B7E7550","#1E7CAF50","#EA425F50","#46489A50","#E5003350","#0F231F50","#1187CD50")
options(scipen = 4)

###################################################################################################
################################            READ IN DATA           ################################
###################################################################################################
input_file <- sys_argv[1]
out_dir <- sys_argv[2]
data <- read.table(input_file,header=T)
x <- data[,1]
y <- data[,2]/1e6
###################################################################################################
################################                PLOT               ################################
###################################################################################################
temp = basename(input_file)
name = sub("\\..*$", "", temp)
pdf(paste0(out_dir,'/',name,".FragmentsLength.pdf"),width=5,height=5)
plot(x,y,main=name,xlab="Fragments length",ylab="Frequency (M)",lwd=2,col=cccol[1],type="l",ylim=c(0,max(y)*1.2))
box(lwd=2)
abline(v=100,lwd=2,lty=2)
total<- sum(y)
part_index <- which(x<=100)
part <- sum(y[part_index])
ratio <- round(part/total*100,2)
text(x=50,y=max(y)*1.1,paste(ratio,"%",sep=""),col=cccol[2])
# text(x=50,y=max(data[,2])*1.1,paste(ratio,"%\n(",part,")",sep=""),col=cccol[2])
dev.off()

